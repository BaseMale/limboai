name: Setup version

runs:
  using: "composite"
  steps:
    - name: Set GDEXTENSION_VERSION & LIMBOAI_VERSION
      shell: bash
      run: |
        cd godot-cpp
        echo "GDEXTENSION_VERSION=$( (git describe --tags --exact-match HEAD || git rev-parse --short HEAD) | sed 's/\(.*\)-\(.*\)/\1/g' )" >> "$GITHUB_ENV"
        cd ../limboai
        echo "LIMBOAI_VERSION=$( (git describe --tags --exact-match HEAD || git rev-parse --short HEAD) | sed 's/\(.*\)-\(.*\)/\1/g' )" >> "$GITHUB_ENV"

    - name: Set NAME_PREFIX
      shell: bash
      run: echo "NAME_PREFIX=${GDEXTENSION_VERSION}.limboai+${LIMBOAI_VERSION}" >> "$GITHUB_ENV"

